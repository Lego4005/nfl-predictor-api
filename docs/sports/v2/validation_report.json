{
  "validation_timestamp": "2025-09-17T00:40:18.909172",
  "file_structure": {
    "files_exist": {
      "01_insert_teams.sql": true,
      "02_insert_players.sql": true,
      "03_insert_games.sql": true,
      "integration_summary.json": true
    },
    "file_sizes": {
      "01_insert_teams.sql": 0.0,
      "02_insert_players.sql": 0.14,
      "03_insert_games.sql": 0.14,
      "integration_summary.json": 0.0,
      "04_insert_plays_part_01.sql": 2.42,
      "04_insert_plays_part_02.sql": 2.43,
      "04_insert_plays_part_03.sql": 2.44,
      "04_insert_plays_part_04.sql": 2.42,
      "04_insert_plays_part_05.sql": 2.42,
      "04_insert_plays_part_06.sql": 2.43,
      "04_insert_plays_part_07.sql": 2.43,
      "04_insert_plays_part_08.sql": 2.44,
      "04_insert_plays_part_09.sql": 2.43,
      "04_insert_plays_part_10.sql": 2.43,
      "04_insert_plays_part_11.sql": 2.41,
      "04_insert_plays_part_12.sql": 2.41,
      "04_insert_plays_part_13.sql": 2.41,
      "04_insert_plays_part_14.sql": 2.41,
      "04_insert_plays_part_15.sql": 2.41,
      "04_insert_plays_part_16.sql": 2.4,
      "04_insert_plays_part_17.sql": 2.4,
      "04_insert_plays_part_18.sql": 2.41,
      "04_insert_plays_part_19.sql": 2.39,
      "04_insert_plays_part_20.sql": 2.38,
      "04_insert_plays_part_21.sql": 2.4,
      "04_insert_plays_part_22.sql": 2.4,
      "04_insert_plays_part_23.sql": 2.41,
      "04_insert_plays_part_24.sql": 2.41,
      "04_insert_plays_part_25.sql": 2.41,
      "04_insert_plays_part_26.sql": 2.4,
      "04_insert_plays_part_27.sql": 2.41,
      "04_insert_plays_part_28.sql": 2.41,
      "04_insert_plays_part_29.sql": 2.4,
      "04_insert_plays_part_30.sql": 1.72
    },
    "plays_files_count": 30,
    "total_size_mb": 71.97
  },
  "sql_syntax": {
    "syntax_errors": [],
    "files_checked": 33,
    "total_statements": 302
  },
  "data_integrity": {
    "teams_validation": {
      "insert_statements": 1,
      "expected_teams": 32,
      "teams_match": true
    },
    "games_validation": {
      "estimated_games": 0,
      "expected_games": 854,
      "games_reasonable": false
    },
    "players_validation": {
      "insert_statements": 2,
      "expected_players": 1699,
      "players_reasonable": true
    },
    "plays_validation": {
      "files_checked": 3,
      "total_files": 30,
      "insert_statements_sample": 30,
      "expected_total_plays": 148591,
      "plays_reasonable": true
    }
  },
  "data_quality": {
    "sample_validation": {
      "teams": {
        "required_teams_found": 6,
        "total_required": 6,
        "all_found": true
      },
      "games": {
        "seasons_found": {
          "2024": true,
          "2023": true,
          "2022": true
        },
        "all_seasons_present": true
      },
      "plays": {
        "play_types_found": 3,
        "total_play_types": 4,
        "variety_good": true
      }
    },
    "data_types": {},
    "null_checks": {}
  },
  "test_queries": [
    "SELECT COUNT(*) as total_teams FROM nfl_teams;",
    "SELECT COUNT(*) as total_players FROM nfl_players;",
    "SELECT COUNT(*) as total_games FROM nfl_games;",
    "SELECT COUNT(*) as total_plays FROM nfl_plays;",
    "SELECT season, COUNT(*) as games_per_season FROM nfl_games GROUP BY season ORDER BY season;",
    "SELECT play_type, COUNT(*) as play_count FROM nfl_plays WHERE play_type IS NOT NULL GROUP BY play_type ORDER BY play_count DESC LIMIT 10;",
    "SELECT home_team, COUNT(*) as home_games FROM nfl_games GROUP BY home_team ORDER BY home_games DESC;",
    "SELECT possession_team, AVG(expected_points_added) as avg_epa FROM nfl_plays WHERE expected_points_added IS NOT NULL GROUP BY possession_team ORDER BY avg_epa DESC LIMIT 10;",
    "SELECT player_name, COUNT(*) as total_plays FROM nfl_plays p JOIN nfl_players pl ON p.passer_id = pl.player_id GROUP BY player_name ORDER BY total_plays DESC LIMIT 10;",
    "SELECT COUNT(*) as games_missing_scores FROM nfl_games WHERE home_score IS NULL OR away_score IS NULL;",
    "SELECT COUNT(*) as plays_missing_teams FROM nfl_plays WHERE possession_team IS NULL;",
    "SELECT COUNT(*) as invalid_downs FROM nfl_plays WHERE down NOT IN (1,2,3,4) AND down IS NOT NULL;"
  ],
  "overall_score": 89.8
}